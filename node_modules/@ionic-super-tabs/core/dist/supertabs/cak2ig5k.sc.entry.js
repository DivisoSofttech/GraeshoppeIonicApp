const t=window.SuperTabs.h;import{a as e,b as i,c as s,d as n,e as o}from"./chunk-39d8d03b.js";class a{async getRootScrollableEl(){if(this.el.scrollHeight>this.el.clientHeight)return this.el;const t=this.el.querySelector("ion-content");return t?t.getScrollElement():null}render(){return t("slot",null)}static get is(){return"super-tab"}static get encapsulation(){return"shadow"}static get properties(){return{el:{elementRef:!0},getRootScrollableEl:{method:!0}}}static get style(){return".sc-super-tab-h{height:100%;position:relative;display:block;overflow:hidden;z-index:1;-ms-flex-negative:0;flex-shrink:0;-ms-flex-positive:0;flex-grow:0;width:var(--super-tab-width,100vw);-webkit-transform:translateZ(0);transform:translateZ(0)}ion-nav.sc-super-tab{height:100%;max-height:100%}ion-nav.sc-super-tab, ion-nav.sc-super-tab > .ion-page.sc-super-tab{position:absolute}"}}class h{constructor(){this.activeTabIndex=0,this._config=e}setConfig(t){this._config=Object.assign({},e,t),this.container&&(this.container.config=this._config),this.toolbar&&(this.toolbar.config=this._config)}selectTab(t,e=!0){this.container&&this.container.moveContainerByIndex(t,e),this.toolbar&&this.toolbar.setActiveTab(t)}onConfigChange(t){this.setConfig(t)}onContainerSelectedTabChange(t){this.toolbar&&this.toolbar.setSelectedTab(t.detail)}onContainerActiveTabChange(t){const e=t.detail;this.tabChange.emit({changed:e!==this.activeTabIndex,index:e}),this.activeTabIndex=e,this.toolbar&&this.toolbar.setActiveTab(e)}onToolbarButtonClick(t){const{index:e}=t.detail;this.container&&this.container.setActiveTabIndex(e),this.tabChange.emit({changed:e!==this.activeTabIndex,index:e}),this.activeTabIndex=e}indexChildren(){const t=this.el.querySelector("super-tabs-container"),e=this.el.querySelector("super-tabs-toolbar");t&&this.container!==t&&(this.container=t,t.config=this._config),e&&this.toolbar!==e&&(this.toolbar=e,e.config=this._config)}componentDidUpdate(){this.indexChildren(),this.selectTab(this.activeTabIndex)}componentWillLoad(){this.indexChildren(),this.selectTab(this.activeTabIndex),this.el.addEventListener("selectedTabIndexChange",this.onContainerSelectedTabChange.bind(this)),this.el.addEventListener("activeTabIndexChange",this.onContainerActiveTabChange.bind(this)),this.el.addEventListener("buttonClick",this.onToolbarButtonClick.bind(this))}render(){return[t("slot",{name:"top"}),t("slot",null),t("slot",{name:"bottom"})]}static get is(){return"super-tabs"}static get encapsulation(){return"shadow"}static get properties(){return{activeTabIndex:{type:Number,attr:"active-tab-index",reflectToAttr:!0,mutable:!0},config:{type:"Any",attr:"config",watchCallbacks:["onConfigChange"]},el:{elementRef:!0},selectTab:{method:!0},setConfig:{method:!0}}}static get events(){return[{name:"tabChange",method:"tabChange",bubbles:!0,cancelable:!0,composed:!0}]}static get style(){return".sc-super-tabs-h{-webkit-box-sizing:content-box;box-sizing:content-box;height:100%;max-height:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow:hidden;z-index:1;position:relative;contain:layout size style}"}}class r{constructor(){this.swipeEnabled=!0,this.autoScrollTop=!1,this.tabs=[],this._activeTabIndex=0,this.leftThreshold=0,this.rightThreshold=0,this.scrollWidth=0,this.clientWidth=0}componentDidLoad(){this.indexTabs()}componentDidUpdate(){this.indexTabs()}moveContainerByIndex(t,e){const i=this.indexToPosition(t);return this.moveContainer(i,e)}moveContainer(t,e){i(this.el,t,0,e?this.config.transitionDuration:0,this.queue)}setActiveTabIndex(t){if(this._activeTabIndex===t){if(!this.autoScrollTop)return;const t=this.tabs[this._activeTabIndex];this.queue.read(()=>{t.getRootScrollableEl().then(t=>{t&&this.queue.write(()=>{i(t,0,0,this.config.transitionDuration,this.queue)})})})}this.moveContainerByIndex(t,!0),this.updateActiveTabIndex(t,!1)}updateActiveTabIndex(t,e=!0){this._activeTabIndex=t,e&&this.activeTabIndexChange.emit(this._activeTabIndex)}updateSelectedTabIndex(t){t!==this._selectedTabIndex&&(this._selectedTabIndex=t,this.selectedTabIndexChange.emit(this._selectedTabIndex))}async onWindowResize(){this.indexTabs()}async onTouchStart(t){if(!this.swipeEnabled)return;let e=t.target;if(e)do{if("function"==typeof e.getAttribute&&e.getAttribute("avoid-super-tabs"))return void(this.shouldCapture=!1);e=e.parentElement}while(e);const i=s(t);i.x<this.leftThreshold||i.x>this.clientWidth-this.rightThreshold?this.shouldCapture=!1:(this.initialCoords=i,this.config.shortSwipeDuration>0&&(this.initialTimestamp=window.performance.now()),this.lastPosX=i.x)}async onTouchMove(t){this.swipeEnabled&&this.queue.read(()=>{const e=s(t);if(!this.isDragging){if("boolean"!=typeof this.shouldCapture&&(this.shouldCapture=n(e,this.initialCoords,this.config)),!0!==this.shouldCapture)return;this.isDragging=!0}this.config.allowElementScroll||(t.stopPropagation(),t.preventDefault());const i=this.lastPosX-e.x;if(0===i)return;const a=this.el.scrollLeft,h=o(this.el,i);h!==a&&(this.updateSelectedTabIndex(this.positionToIndex(h)),this.queue.write(()=>{this.lastPosX=e.x,this.moveContainer(h,!1)}))})}async onTouchEnd(t){if(!this.swipeEnabled)return;const e=s(t);if(!0===this.shouldCapture){const t=window.performance.now()-this.initialTimestamp,i=this.config.shortSwipeDuration>0&&t<=this.config.shortSwipeDuration,s=e.x-this.initialCoords.x;this.queue.read(()=>{let t=this.calcSelectedTab();const e=Math.round(t);i&&e===this._activeTabIndex&&(t+=s>0?-1:1),t=this.normalizeSelectedTab(t),this.updateActiveTabIndex(t),this.queue.write(()=>{this.moveContainer(this.indexToPosition(t),!0)})})}this.isDragging=!1,this.shouldCapture=void 0}indexTabs(){this.queue.read(()=>{this.scrollWidth=this.el.scrollWidth,this.clientWidth=this.el.clientWidth;const t=this.el.querySelectorAll("super-tab"),e=[];for(let i=0;i<t.length;i++)e.push(t[i]);this.tabs=e}),"both"!==this.config.sideMenu&&"left"!==this.config.sideMenu||(this.leftThreshold=this.config.sideMenuThreshold),"both"!==this.config.sideMenu&&"right"!==this.config.sideMenu||(this.rightThreshold=this.config.sideMenuThreshold)}calcSelectedTab(){const t=Math.max(0,Math.min(this.scrollWidth-this.clientWidth,this.el.scrollLeft));return this.positionToIndex(t)}positionToIndex(t){return t/this.clientWidth}indexToPosition(t){return t*this.clientWidth}normalizeSelectedTab(t){const e=this.clientWidth;return Math.max(0,Math.min(this.scrollWidth-e,e*Math.round(t)))/e}render(){return t("slot",null)}static get is(){return"super-tabs-container"}static get encapsulation(){return"shadow"}static get properties(){return{autoScrollTop:{type:Boolean,attr:"auto-scroll-top"},config:{type:"Any",attr:"config",mutable:!0},el:{elementRef:!0},moveContainer:{method:!0},moveContainerByIndex:{method:!0},queue:{context:"queue"},setActiveTabIndex:{method:!0},swipeEnabled:{type:Boolean,attr:"swipe-enabled"}}}static get events(){return[{name:"activeTabIndexChange",method:"activeTabIndexChange",bubbles:!0,cancelable:!0,composed:!0},{name:"selectedTabIndexChange",method:"selectedTabIndexChange",bubbles:!0,cancelable:!0,composed:!0}]}static get listeners(){return[{name:"window:resize",method:"onWindowResize",passive:!0},{name:"touchstart",method:"onTouchStart",passive:!0},{name:"touchmove",method:"onTouchMove"},{name:"touchend",method:"onTouchEnd",passive:!0}]}static get style(){return".sc-super-tabs-container-h{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;min-width:100%;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;-webkit-box-sizing:content-box;box-sizing:content-box;width:100%;overflow:hidden;-webkit-transform:translateZ(0);transform:translateZ(0);-ms-touch-action:pan-y;touch-action:pan-y;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;will-change:scroll-position}"}}export{a as SuperTab,h as SuperTabs,r as SuperTabsContainer};